ylab = 'Individuals')
i <- 1
j <- 1
for(j in 1:(counter-1)){
for(i in 1:census){
lines(c(j,(j+1)), history[i,j:(j+1)])
}
}
census <- 10
history <- as.data.frame(1:census)
lineages <- census
counter <- 1
counter <- counter + 1
history[1:10, counter] <- sample(1:census, length(unique(history[, (counter - 1)])), replace = T)
while(lineages > 1){
lineages <- sum(!is.na(unique(history[1:10, counter])))
history[1:lineages, (counter + 1)] <- sort(unique(history[1:10, counter]))
counter <- counter + 1
history[1:lineages, (counter + 1)] <- sample(1:census, length(unique(history[, (counter)])) - 1, replace = T)
counter <- counter + 1
}
## now plot it
plot(0, 0, col = 'white', ylim = c(1,census),
xlim = c(1, counter),
main='Coalesence Simulation',
xlab = 'Generation',
ylab = 'Individuals')
for(j in 1:(counter-1)){
for(i in 1:census){
lines(c(j,(j+1)), history[i,j:(j+1)])
}
}
census <- 6
history <- as.data.frame(1:census)
lineages <- census
counter <- 1
counter <- counter + 1
history[1:10, counter] <- sample(1:census, length(unique(history[, (counter - 1)])), replace = T)
while(lineages > 1){
lineages <- sum(!is.na(unique(history[1:10, counter])))
history[1:lineages, (counter + 1)] <- sort(unique(history[1:10, counter]))
counter <- counter + 1
history[1:lineages, (counter + 1)] <- sample(1:census, length(unique(history[, (counter)])) - 1, replace = T)
counter <- counter + 1
}
## now plot it
plot(0, 0, col = 'white', ylim = c(1,census),
xlim = c(1, counter),
main='Coalesence Simulation',
xlab = 'Generation',
ylab = 'Individuals')
for(j in 1:(counter-1)){
for(i in 1:census){
lines(c(j,(j+1)), history[i,j:(j+1)])
}
}
census <- 6
history <- as.data.frame(1:census)
lineages <- census
counter <- 1
counter <- counter + 1
history[1:10, counter] <- sample(1:census, length(unique(history[, (counter - 1)])), replace = T)
while(lineages > 1){
lineages <- sum(!is.na(unique(history[1:10, counter])))
history[1:lineages, (counter + 1)] <- sort(unique(history[1:10, counter]))
counter <- counter + 1
history[1:lineages, (counter + 1)] <- sample(1:census, length(unique(history[, (counter)])) - 1, replace = T)
counter <- counter + 1
}
## now plot it
plot(0, 0, col = 'white', ylim = c(1,census),
xlim = c(1, counter),
main='Coalesence Simulation',
xlab = 'Generation',
ylab = 'Individuals')
for(j in 1:(counter-1)){
for(i in 1:census){
lines(c(j,(j+1)), history[i,j:(j+1)])
}
}
census <- 6
history <- as.data.frame(1:census)
lineages <- census
counter <- 1
counter <- counter + 1
history[1:census, counter] <- sample(1:census, length(unique(history[, (counter - 1)])), replace = T)
while(lineages > 1){
lineages <- sum(!is.na(unique(history[1:10, counter])))
history[1:lineages, (counter + 1)] <- sort(unique(history[1:10, counter]))
counter <- counter + 1
history[1:lineages, (counter + 1)] <- sample(1:census, length(unique(history[, (counter)])) - 1, replace = T)
counter <- counter + 1
}
## now plot it
plot(0, 0, col = 'white', ylim = c(1,census),
xlim = c(1, counter),
main='Coalesence Simulation',
xlab = 'Generation',
ylab = 'Individuals')
for(j in 1:(counter-1)){
for(i in 1:census){
lines(c(j,(j+1)), history[i,j:(j+1)])
}
}
View(history)
census <- 6
history <- as.data.frame(1:census)
lineages <- census
counter <- 1
counter <- counter + 1
history[1:census, counter] <- sample(1:census, length(unique(history[, (counter - 1)])), replace = T)
while(lineages > 1){
lineages <- sum(!is.na(unique(history[1:10, counter])))
history[1:lineages, (counter + 1)] <- sort(unique(history[1:10, counter]))
counter <- counter + 1
history[1:lineages, (counter + 1)] <- sort(sample(1:census, length(unique(history[, (counter)])) - 1, replace = T))
counter <- counter + 1
}
## now plot it
plot(0, 0, col = 'white', ylim = c(1,census),
xlim = c(1, counter),
main='Coalesence Simulation',
xlab = 'Generation',
ylab = 'Individuals')
for(j in 1:(counter-1)){
for(i in 1:census){
lines(c(j,(j+1)), history[i,j:(j+1)])
}
}
census <- 6
history <- as.data.frame(1:census)
lineages <- census
counter <- 1
counter <- counter + 1
history[1:census, counter] <- sample(1:census, length(unique(history[, (counter - 1)])), replace = T)
while(lineages > 1){
lineages <- sum(!is.na(unique(history[1:10, counter])))
history[1:lineages, (counter + 1)] <- sort(unique(history[1:10, counter]))
counter <- counter + 1
history[1:lineages, (counter + 1)] <- sort(sample(1:census, length(unique(history[, (counter)])) - 1, replace = T))
counter <- counter + 1
}
## now plot it
plot(0, 0, col = 'white', ylim = c(1,census),
xlim = c(1, counter),
main='Coalesence Simulation',
xlab = 'Generation',
ylab = 'Individuals')
for(j in 1:(counter-1)){
for(i in 1:census){
lines(c(j,(j+1)), history[i,j:(j+1)])
}
}
census <- 25
history <- as.data.frame(1:census)
lineages <- census
counter <- 1
counter <- counter + 1
history[1:census, counter] <- sample(1:census, length(unique(history[, (counter - 1)])), replace = T)
while(lineages > 1){
lineages <- sum(!is.na(unique(history[1:10, counter])))
history[1:lineages, (counter + 1)] <- sort(unique(history[1:10, counter]))
counter <- counter + 1
history[1:lineages, (counter + 1)] <- sort(sample(1:census, length(unique(history[, (counter)])) - 1, replace = T))
counter <- counter + 1
}
## now plot it
plot(0, 0, col = 'white', ylim = c(1,census),
xlim = c(1, counter),
main='Coalesence Simulation',
xlab = 'Generation',
ylab = 'Individuals')
for(j in 1:(counter-1)){
for(i in 1:census){
lines(c(j,(j+1)), history[i,j:(j+1)])
}
}
census <- 10
history <- as.data.frame(1:census)
lineages <- census
counter <- 1
counter <- counter + 1
history[1:census, counter] <- sample(1:census, length(unique(history[, (counter - 1)])), replace = T)
while(lineages > 1){
lineages <- sum(!is.na(unique(history[1:10, counter])))
history[1:lineages, (counter + 1)] <- sort(unique(history[1:10, counter]))
counter <- counter + 1
history[1:lineages, (counter + 1)] <- sort(sample(1:census, length(unique(history[, (counter)])) - 1, replace = T))
counter <- counter + 1
}
## now plot it
plot(0, 0, col = 'white', ylim = c(1,census),
xlim = c(1, counter),
main='Coalesence Simulation',
xlab = 'Generation',
ylab = 'Individuals')
for(j in 1:(counter-1)){
for(i in 1:census){
lines(c(j,(j+1)), history[i,j:(j+1)])
}
}
View(history)
census <- 10
history <- as.data.frame(1:census)
lineages <- census
counter <- 1
counter <- counter + 1
history[1:census, counter] <- sample(1:census, length(unique(history[, (counter - 1)])), replace = T)
while(lineages > 1){
lineages <- sum(!is.na(unique(history[1:10, counter])))
history[1:lineages, (counter + 1)] <- sort(unique(history[1:10, counter]))
counter <- counter + 1
history[1:lineages, (counter + 1)] <- sort(sample(1:census, length(unique(history[, (counter)])) - 1, replace = T))
counter <- counter + 1
}
## now plot it
plot(0, 0, col = 'white', ylim = c(1,census),
xlim = c(1, counter),
main='Coalesence Simulation',
xlab = 'Generation',
ylab = 'Individuals')
foo <- 1
while(foo < (counter)){
for(i in 1:census){
lines(c(foo,(foo+1)), history[i,foo:(foo+1)])
foo <- foo + 2
}
}
plot(0, 0, col = 'white', ylim = c(1,census),
xlim = c(1, counter),
main='Coalesence Simulation',
xlab = 'Generation',
ylab = 'Individuals')
foo <- 1
i<-1
foo <- 1
while(foo < (counter)){
for(i in 1:census){
lines(c(foo,(foo+1)), history[i,foo:(foo+1)])
}
foo <- foo + 2
}
census <- 10
history <- as.data.frame(1:census)
lineages <- census
counter <- 1
counter <- counter + 1
history[1:census, counter] <- sample(1:census, length(unique(history[, (counter - 1)])), replace = T)
while(lineages > 1){
lineages <- sum(!is.na(unique(history[1:10, counter])))
history[1:lineages, (counter + 1)] <- sort(unique(history[1:10, counter]))
counter <- counter + 1
history[1:lineages, (counter + 1)] <- sort(sample(1:census, length(unique(history[, (counter)])) - 1, replace = T))
counter <- counter + 1
}
## now plot it
plot(0, 0, col = 'white', ylim = c(1,census),
xlim = c(1, counter),
main='Coalesence Simulation',
xlab = 'Generation',
ylab = 'Individuals')
foo <- 1
foox <- 1
while(foo < (counter)){
for(i in 1:census){
lines(c(foox,(foox + 1)), history[i,foo:(foo + 1)])
}
foo <- foo + 2
foox <- foox + 1
}
plot(0, 0, col = 'white', ylim = c(1,census),
xlim = c(1, counter/2 + 1),
main='Coalesence Simulation',
xlab = 'Generation',
ylab = 'Individuals')
foo <- 1
foox <- 1
while(foo < (counter)){
for(i in 1:census){
lines(c(foox,(foox + 1)), history[i,foo:(foo + 1)])
}
foo <- foo + 2
foox <- foox + 1
}
census <- 50
history <- as.data.frame(1:census)
lineages <- census
counter <- 1
counter <- counter + 1
history[1:census, counter] <- sample(1:census, length(unique(history[, (counter - 1)])), replace = T)
while(lineages > 1){
lineages <- sum(!is.na(unique(history[1:10, counter])))
history[1:lineages, (counter + 1)] <- sort(unique(history[1:10, counter]))
counter <- counter + 1
history[1:lineages, (counter + 1)] <- sort(sample(1:census, length(unique(history[, (counter)])) - 1, replace = T))
counter <- counter + 1
}
## now plot it
plot(0, 0, col = 'white', ylim = c(1,census),
xlim = c(1, counter/2 + 1),
main='Coalesence Simulation',
xlab = 'Generation',
ylab = 'Individuals')
foo <- 1
foox <- 1
while(foo < (counter)){
for(i in 1:census){
lines(c(foox,(foox + 1)), history[i,foo:(foo + 1)])
}
foo <- foo + 2
foox <- foox + 1
}
census <- 40
history <- as.data.frame(1:census)
lineages <- census
counter <- 1
counter <- counter + 1
history[1:census, counter] <- sample(1:census, length(unique(history[, (counter - 1)])), replace = T)
while(lineages > 1){
lineages <- sum(!is.na(unique(history[1:10, counter])))
history[1:lineages, (counter + 1)] <- sort(unique(history[1:10, counter]))
counter <- counter + 1
history[1:lineages, (counter + 1)] <- sort(sample(1:census, length(unique(history[, (counter)])) - 1, replace = T))
counter <- counter + 1
}
## now plot it
plot(0, 0, col = 'white', ylim = c(1,census),
xlim = c(1, counter/2 + 1),
main='Coalesence Simulation',
xlab = 'Generation',
ylab = 'Individuals')
foo <- 1
foox <- 1
while(foo < (counter)){
for(i in 1:census){
lines(c(foox,(foox + 1)), history[i,foo:(foo + 1)])
}
foo <- foo + 2
foox <- foox + 1
}
census <- 20
history <- as.data.frame(1:census)
lineages <- census
counter <- 1
counter <- counter + 1
history[1:census, counter] <- sample(1:census, length(unique(history[, (counter - 1)])), replace = T)
while(lineages > 1){
lineages <- sum(!is.na(unique(history[1:10, counter])))
history[1:lineages, (counter + 1)] <- sort(unique(history[1:10, counter]))
counter <- counter + 1
history[1:lineages, (counter + 1)] <- sort(sample(1:census, length(unique(history[, (counter)])) - 1, replace = T))
counter <- counter + 1
}
## now plot it
plot(0, 0, col = 'white', ylim = c(1,census),
xlim = c(1, counter/2 + 1),
main='Coalesence Simulation',
xlab = 'Generation',
ylab = 'Individuals')
foo <- 1
foox <- 1
while(foo < (counter)){
for(i in 1:census){
lines(c(foox,(foox + 1)), history[i,foo:(foo + 1)])
}
foo <- foo + 2
foox <- foox + 1
}
library(devtools)
install.packages("devtools")
library(devtools)
install_github("evobiR")
help(install_github)
install_github("evobiR", username='coleoguy')
install_git("evobiR", username='coleoguy')
install.packages('LearnBayes')
install.packages('evobiR')
install.packages("ape")
install.packages("shiny")
library(shiny)
runExample("01_hello")
library("evobiR", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
foo <- data(mite)
data(mite)
load(mite.data)
data(mite.data)
rownames(mite.data)
install.packages("markovjumps")
install.packages("~/Desktop/mypack/example.R.packages/markovjumps.tar.gz", repos = NULL, type = "source")
chromosomes <- 23
ploidy <- 2
results <- vector()
for(i in 1:chromosomes){
results[i] <- chromosomes^ploidy
}
plot(results)
results <- vector()
for(i in 1:chromosomes){
results[i] <- i^ploidy
}
plot(results)
plot(results, lty=1)
plot(results, lty=2)
plot(results, lty=3)
help(plot)
plot(results, type='l')
install_github("evobir", username='coleoguy')
library(devtools)
install_github("evobir", username='coleoguy')
library(evobiR)
ViewEvo("wf.model")
setwd("~/Desktop/Dropbox/papers/chrom.num/data and analysis/figures/par.est")
## First lets just set up the results table for later fill in
results <- as.data.frame(matrix(,1,10))
colnames(results) <- c("group", "alpha", "sigma", "z",
"lb.alpha", "lb.sigma", "lb.z",
"ub.alpha", "ub.sigma", "ub.z")
data <- read.csv("par.est.csv", as.is=T)
par.means <- read.csv("par.means.csv", as.is=T)
fams <- unique(par.means[,2])
for(i in 1:9){
fam <- fams[i]
results[i,1] <- fam
results[i,2] <- mean(par.means[par.means[,2] == fam, "alpha"])
results[i,3] <- mean(par.means[par.means[,2] == fam, "sigma"])
results[i,4] <- mean(par.means[par.means[,2] == fam, "z"])
results[i,5] <- min(data[data[,2] == fam, "alpha.lb"], na.rm = T)
results[i,6] <- min(data[data[,2] == fam, "sigma2.lb"], na.rm = T)
results[i,7] <- min(data[data[,2] == fam, "z.lb.1"], na.rm = T)
results[i,8] <- max(data[data[,2] == fam, "alpha.ub"], na.rm = T)
results[i,9] <- max(data[data[,2] == fam, "sigma2.ub"], na.rm = T)
results[i,10] <- max(data[data[,2] == fam, "z.ub.1"], na.rm = T)
}
## now we want to create a graph that has a symbol for the means with error
## bars representing the worst and mean 95% CI from across trees
View(results)
View(data)
plot(results[1:9,"sigma2.lb"])
View(par.means)
plot(results[1:9,"lb.sigma"])
plot(results[1:9,"ub.sigma"])
plot(results[1:9,"ub.sigma"])
points(results[1:9,"lb.sigma"])
View(results)
View(par.means)
fams <- results$groups
View(results)
fams <- results$group
View(par.means)
View(par.means)
plot(density(par.means[par.means$group == fams[1],"sigma"]))
plot(density(par.means[par.means$group == fams[2],"sigma"]))
plot(density(par.means[par.means$group == fams[3],"sigma"]))
plot(density(par.means[par.means$group == fams[4],"sigma"]))
plot(density(par.means[par.means$group == fams[5],"sigma"]))
plot(density(par.means[par.means$group == fams[6],"sigma"]))
plot(density(par.means[par.means$group == fams[7],"sigma"]))
plot(density(par.means[par.means$group == fams[8],"sigma"]))
plot(density(par.means[par.means$group == fams[9],"sigma"]))
par.means[par.means$group == fams[9],"sigma"]
median(par.means[par.means$group == fams[9],"sigma"])
View(par.means)
setwd("~/Desktop/Dropbox/papers/chrom.num/data and analysis/figures/par.est/Carabidae")
data <- read.csv("data.csv", as.is=T)
chrom <- data[,2]
names(chrom) <- data[,1]
tree <- read.tree("Carabidae31.tree")
library(geiger)
tree <- read.tree("Carabidae31.tree")
fitContinuous(tree, chrom, model="OU")
tree <- read.tree("Carabidae30.tree")
fitContinuous(tree, chrom, model="OU")
library(phytools)
help(contMap)
contMap(tree, chrom)
tree <- read.tree("Carabidae31.tree")
contMap(tree, chrom)
tree <- read.tree("Carabidae31.tree")
contMap(tree, chrom, lwd=.5)
tree <- read.tree("Carabidae30.tree")
contMap(tree, chrom, lwd=.5)
fitContinuous(tree, chrom, model="BM")
tree <- read.tree("Carabidae31.tree")
fitContinuous(tree, chrom, model="BM")
fitContinuous(tree, chrom, model="BM")$opt$sigsq
tree <- read.tree("Carabidae31.tree")
tree1 <- read.tree("Carabidae30.tree")
tree2 <- read.tree("Carabidae10.tree")
tree3 <- read.tree("Carabidae50.tree")
tree4 <- read.tree("Carabidae60.tree")
tree5 <- read.tree("Carabidae100.tree")
tree <- read.tree("Carabidae31.tree")
tree1 <- read.tree("Carabidae30.tree")
tree2 <- read.tree("Carabidae10.tree")
tree3 <- read.tree("Carabidae50.tree")
tree4 <- read.tree("Carabidae60.tree")
tree5 <- read.tree("Carabidae100.tree")
fitContinuous(tree, chrom, model="BM")$opt$sigsq
fitContinuous(tree1, chrom, model="BM")$opt$sigsq
fitContinuous(tree2, chrom, model="BM")$opt$sigsq
fitContinuous(tree3, chrom, model="BM")$opt$sigsq
fitContinuous(tree4, chrom, model="BM")$opt$sigsq
fitContinuous(tree5, chrom, model="BM")$opt$sigsq
help(fitContinuous)
fitContinuous(tree, chrom, model="BM", control = list(niter=500))$opt$sigsq
fitContinuous(tree1, chrom, model="BM", control = list(niter=500))$opt$sigsq
fitContinuous(tree2, chrom, model="BM", control = list(niter=500))$opt$sigsq
fitContinuous(tree3, chrom, model="BM", control = list(niter=500))$opt$sigsq
fitContinuous(tree4, chrom, model="BM", control = list(niter=500))$opt$sigsq
fitContinuous(tree5, chrom, model="BM", control = list(niter=500))$opt$sigsq
fitContinuous(tree5, chrom, model="OU", control = list(niter=500))$opt$sigsq
View(results)
