setwd("~/Desktop/genome.sim/test")
gen.2000pop.200<-foo
save(gen.2000pop.200, file='results2')
foo <- GenomeSymC(generations = 2000, census=100,
seed.val = 2,sex.ant = c(.2, .4, .4))
source("GenomeSym.R")
foo <- GenomeSymC(generations = 2000, census=100,
seed.val = 2,sex.ant = c(.2, .4, .4))
foo <- GenomeSymC(generations = 2000, census=20,
seed.val = 2,sex.ant = c(.2, .4, .4))
foo <- GenomeSymC(generations = 2000, census=10,
seed.val = 2,sex.ant = c(.2, .4, .4))
.5^10
foo <- GenomeSymC(generations = 2000, census=10,
seed.val = 2,sex.ant = c(.2, .4, .4))
foo <- GenomeSymC(generations = 2000, census=50,
seed.val = 2,sex.ant = c(.2, .4, .4))
load('result')
setwd("~/Desktop/genome.sim/test")
load('result')
load('results')
load('results2')
x <- load('results')
x <- gen.2000.pop.500
y <- gen.2000pop.200
x[[1]]
sire.y <- matrix(,500,50)
dam.y <- matrix(,500,50)
xy.reco <- matrix(,500,50)
sire.y <- matrix(,500,50)
dam.y <- matrix(,500,50)
xy.reco <- matrix(,500,50)
for(i in 1:500){
sire.y[i, ] <- x[[i]]['y.1.s',]
dam.y[i, ] <- x[[i]]['y.1.d',]
xy.reco[i, ] <- x[[i]]['xyrecom2',]
}
sire.y <- matrix(,500,50)
dam.y <- matrix(,500,50)
xy.reco <- matrix(,500,50)
for(i in 1:500){
sire.y[i, ] <- x[[i]]['y.1.s',]
dam.y[i, ] <- x[[i]]['y.1.d',]
xy.reco[i, ] <- x[[i]]['xy.recom2',]
}
View(dam.y)
dx <- colMean(dam.y)
dx <- colMeans(dam.y)
fix(dx)
View(dam.y)
sire.y <- sire.y[sire.y[,1 ] == 0,]
dam.y <-  dam.y[dam.y[,1 ] == 0,]
sire.y <- sire.y[sire.y[,1 ] == 0,]
dam.y <-  dam.y[dam.y[,1 ] == 0,]
View(xy.reco)
dx <- colMeans(dam.y)
fix(dx)
for(i in 1:500){
sire.y[i, ] <- x[[i]]['y.1.s',]
dam.y[i, ] <- x[[i]]['y.1.d',]
xy.reco[i, ] <- x[[i]]['xy.recom2',]
}
sire.y <- sire.y[sire.y[,1 ] != 0,]
sire.y <- matrix(,500,50)
dam.y <- matrix(,500,50)
xy.reco <- matrix(,500,50)
for(i in 1:500){
sire.y[i, ] <- x[[i]]['y.1.s',]
dam.y[i, ] <- x[[i]]['y.1.d',]
xy.reco[i, ] <- x[[i]]['xy.recom2',]
}
sire.y <- sire.y[sire.y[,1 ] != 0,]
dam.y <-  dam.y[dam.y[,1 ] != 0,]
xy.reco[i, ] <- x[[i]]['xy.recom2',]
dx <- colMeans(dam.y)
fix(dx)
dx
sx <- colMeans(sire.y)
sx
View(dam.y)
plot(sx)
plot(sx, log="y")
plot(dx)
ry <- colMeans(xy.reco)
dy <- colMeans(dam.y)
sy <- colMeans(sire.y)
fix(ry)
plot(ry, type="l", col='blue')
fix(ry)
source("GenomeSym.R")
setwd("~/Desktop/genome.sim")
source("GenomeSym.R")
foo <- GenomeSymC(generations = 2000, census=50,
seed.val = 2,sex.ant = c(.2, .4, .4))
ry
ry[5:9] <- c(.4,.4,.44,.45,.46,.47)
ry[5:9] <- c(.4,.4,.44,.45,.46)
ry
plot(ry, type="l", col='blue')
ry[10] <- .48
plot(ry, type="l", col='blue')
lines(dy)
plot(ry, type="l", col='blue' ylim=c(0,1.5))
lines(dy)
plot(ry, type="l", col='blue', ylim=c(0,1.5))
lines(dy)
points(dy, col='pink', pch=19, cex=.5)
points(sy, col='blue', pch=19, cex=.5)
plot(ry, type="l", col='blue', ylim=c(0,1.5))
points(dy, col='pink', pch=19, cex=.5)
points(sy, col='blue', pch=19, cex=.5)
points(dy, col='lightred', pch=19, cex=.5)
colors()
points(dy, col='lightsalmon', pch=19, cex=.5)
points(sy, col='blue', pch=19, cex=.5)
plot(ry, type="l", col='blue', ylim=c(0,1.5), main="N=500, Gen=2000")
points(dy, col='lightsalmon', pch=19, cex=.5)
points(sy, col='blue', pch=19, cex=.5)
plot(ry, type="l", col='blue', ylim=c(0,1.5), main="N=500, Gen=2000",ylab='Fitness/Prob.Recom')
plot(ry, type="l", col='blue', ylim=c(0,1.5), main="N=500, Gen=2000",ylab='Fitness/Prob.Recom', xlab="Loci")
points(dy, col='lightsalmon', pch=19, cex=.5)
points(sy, col='blue', pch=19, cex=.5)
load('results')
load('results2')
x <- gen.2000.pop.500
y <- gen.2000pop.200
sire.y <- matrix(,500,50)
dam.y <- matrix(,500,50)
xy.reco <- matrix(,500,50)
for(i in 1:500){
sire.y[i, ] <- x[[i]]['y.1.s',]
dam.y[i, ] <- x[[i]]['y.1.d',]
xy.reco[i, ] <- x[[i]]['xy.recom2',]
}
sire.y <- sire.y[sire.y[,1 ] != 0,]
dam.y <-  dam.y[dam.y[,1 ] != 0,]
xy.reco[i, ] <- x[[i]]['xy.recom2',]
ry <- colMeans(xy.reco)
dy <- colMeans(dam.y)
sy <- colMeans(sire.y)
sire.y2 <- matrix(,500,50)
dam.y2 <- matrix(,500,50)
xy.reco2 <- matrix(,500,50)
for(i in 1:500){
sire.y2[i, ] <- y[[i]]['y.1.s',]
dam.y2[i, ] <- y[[i]]['y.1.d',]
xy.reco2[i, ] <- y[[i]]['xy.recom2',]
}
sire.y2 <- sire.y2[sire.y2[,1 ] != 0,]
dam.y2 <-  dam.y2[dam.y2[,1 ] != 0,]
xy.reco2[i, ] <- y[[i]]['xy.recom2',]
ry2 <- colMeans(xy.reco2)
dy2 <- colMeans(dam.y2)
sy2 <- colMeans(sire.y2)
setwd("~/Desktop/genome.sim/test")
load('results')
load('results2')
x <- gen.2000.pop.500
y <- gen.2000pop.200
sire.y <- matrix(,500,50)
dam.y <- matrix(,500,50)
xy.reco <- matrix(,500,50)
for(i in 1:500){
sire.y[i, ] <- x[[i]]['y.1.s',]
dam.y[i, ] <- x[[i]]['y.1.d',]
xy.reco[i, ] <- x[[i]]['xy.recom2',]
}
sire.y <- sire.y[sire.y[,1 ] != 0,]
dam.y <-  dam.y[dam.y[,1 ] != 0,]
xy.reco[i, ] <- x[[i]]['xy.recom2',]
ry <- colMeans(xy.reco)
dy <- colMeans(dam.y)
sy <- colMeans(sire.y)
sire.y2 <- matrix(,500,50)
dam.y2 <- matrix(,500,50)
xy.reco2 <- matrix(,500,50)
for(i in 1:500){
sire.y2[i, ] <- y[[i]]['y.1.s',]
dam.y2[i, ] <- y[[i]]['y.1.d',]
xy.reco2[i, ] <- y[[i]]['xy.recom2',]
}
sire.y2 <- sire.y2[sire.y2[,1 ] != 0,]
dam.y2 <-  dam.y2[dam.y2[,1 ] != 0,]
xy.reco2[i, ] <- y[[i]]['xy.recom2',]
ry2 <- colMeans(xy.reco2)
dy2 <- colMeans(dam.y2)
sy2 <- colMeans(sire.y2)
load('results')
load('results2')
x <- gen.2000.pop.500
y <- gen.2000pop.200
sire.y <- matrix(,500,50)
dam.y <- matrix(,500,50)
xy.reco <- matrix(,500,50)
for(i in 1:500){
sire.y[i, ] <- x[[i]]['y.1.s',]
dam.y[i, ] <- x[[i]]['y.1.d',]
xy.reco[i, ] <- x[[i]]['xy.recom2',]
}
sire.y <- sire.y[sire.y[,1 ] != 0,]
dam.y <-  dam.y[dam.y[,1 ] != 0,]
xy.reco[i, ] <- x[[i]]['xy.recom2',]
ry <- colMeans(xy.reco)
dy <- colMeans(dam.y)
sy <- colMeans(sire.y)
sire.y2 <- matrix(,500,50)
dam.y2 <- matrix(,500,50)
xy.reco2 <- matrix(,500,50)
for(i in 1:500){
sire.y2[i, ] <- y[[i]]['y.1.s',]
dam.y2[i, ] <- y[[i]]['y.1.d',]
xy.reco2[i, ] <- y[[i]]['xy.recom2',]
}
y[[1]]
sire.y2 <- matrix(,200,50)
dam.y2 <- matrix(,200,50)
xy.reco2 <- matrix(,200,50)
for(i in 1:200){
sire.y2[i, ] <- y[[i]]['y.1.s',]
dam.y2[i, ] <- y[[i]]['y.1.d',]
xy.reco2[i, ] <- y[[i]]['xy.recom2',]
}
sire.y2 <- sire.y2[sire.y2[,1 ] != 0,]
dam.y2 <-  dam.y2[dam.y2[,1 ] != 0,]
xy.reco2[i, ] <- y[[i]]['xy.recom2',]
ry2 <- colMeans(xy.reco2)
dy2 <- colMeans(dam.y2)
sy2 <- colMeans(sire.y2)
plot(ry2, type="l", col='blue', ylim=c(0,1.5), main="N=200, Gen=2000",ylab='Fitness/Prob.Recom', xlab="Loci")
points(dy2, col='lightsalmon', pch=19, cex=.5)
points(sy2, col='blue', pch=19, cex=.5)
setwd("~/Desktop/Dropbox/papers/chrom.num/data and analysis/analyses")
library(ape)
library(geiger)
# Get the data in
trees <- read.nexus("../data/trees.nexus")
groups <- read.csv('../data/groups.csv', as.is = T)
data <- read.csv('../data/chrom.nums.csv', as.is = T)
data.v <- data[,2]
names(data.v) <- data[,1]
rm(data)
setwd("~/Desktop/Dropbox/papers/chrom.num/data and analysis/analyses/chrom.evol")
# Create input data files fasta format for chrom numbers and all the trees
for(i in 1:ncol(groups)){
dir.create(colnames(groups[i]))
foo <- treedata(trees[[1]], data.v[names(data.v) %in% groups[,i]])
phy <- foo[[1]]
dat <- foo[[2]]
ids <- paste(rep(">", length(dat)),row.names(dat), sep = "")
vals <- as.character(round(dat))  # I have to round to make it work for itays program
final <- vector()
for(j in 1:length(dat)){
final <- paste(final, ids[j], "\n", vals[j], "\n", sep = "")
}
cat(final, file= paste(colnames(groups[i]), "/",
colnames(groups)[i], ".txt", sep = ""))
for( k in 1:20){  #takes to long to look at all trees
sub.tree <- treedata(trees[[sample(1:100, 1)]], data.v[names(data.v) %in% groups[,i]])[[1]]
write.tree(sub.tree, file= paste(colnames(groups[i]), "/",
colnames(groups)[i], k,
".tree", sep = ""))
}
}
for(i in 1:ncol(groups)){
for(j in 1:20){
params <- paste('_mainType Optimize_Model\n',
'_outDir result', j, '\n', '_dataFile ', colnames(groups[i]),
'.txt\n',
'_treeFile ', colnames(groups[i]),
j, '.tree\n', '_maxChrNum -10\n',
'_minChrNum -1\n',
'_simulationsNum 0\n', '_gainConstR = 1\n',
'_lossConstR = 1\n', '_duplConstR = 1\n', sep = '')
cat(params, file= paste(colnames(groups[i]), "/",
'params', j, ".txt", sep = ""))
}
}
setwd("~/Desktop/Dropbox/papers/chrom.num/data and analysis/analyses/brownian")
library(ape)
library(geiger)
# Get the data in
trees <- read.nexus("../../data/trees.nexus")
groups <- read.csv('../../data/groups.csv', as.is = T)
data <- read.csv('../../data/chrom.nums.csv', as.is = T)
data.v <- data[,2]
names(data.v) <- data[,1]
rm(data)
fix(data.v)
View(groups)
View(groups)
colnames(groups)
groups <- c("Bembidion", "Calathus", "Carabidae", "Carabus",
"Cerambycidae", "Chrysolina", "Chrysomelidae",
"Cicindela", "Timarcha", "Tenebrionidae", "Scarabaeidae",
"Pterostichus", "Pimelia", "Lampyridae", "Ips",
"Harpalus", "Elateridae", "Dytiscidae", "Diabrotica",
"Dendroctonus", "Cytronus", "Curculionidae", "Coccinellidae")
setwd("~/Desktop/Dropbox/papers/chrom.num/data and analysis/analyses/brownian")
i<-1
getwd()
setwd(paste("~/Desktop/Dropbox/papers/chrom.num/data and analysis/analyses/brownian", groups[i], sep = ""))
paste("~/Desktop/Dropbox/papers/chrom.num/data and analysis/analyses/brownian", groups[i], sep = ""))
paste("~/Desktop/Dropbox/papers/chrom.num/data and analysis/analyses/brownian", groups[i], sep = "")
setwd(paste("~/Desktop/Dropbox/papers/chrom.num/data and analysis/analyses/brownian/", groups[i], sep = ""))
getwd()
paste(groups[i], i, ".tree")
paste(groups[i], i, ".tree", sep = "")
help(ape)
help(ace)
data <- read.csv("data.csv")
View(data)
dat <- data[, 2]
names(dat) <- data[, 1]
foo <- ace(dat, tree, type = "cont", model = "BM")
tree <- read.tree(paste(groups[i], i, ".tree", sep = ""))
data <- read.csv("data.csv")
dat <- data[, 2]
names(dat) <- data[, 1]
foo <- ace(dat, tree, type = "cont", model = "BM")
fix(foo)
ace(dat, tree, type = "cont", model = "BM")
foo$sigma2
foo$sigma[1]
results <- matrix(,46,100)
row.names(results)[counter.a] <- paste(groups[i], ".rate", sep = "")
counter.a <- 1
counter.b <- 2
row.names(results)[counter.a] <- paste(groups[i], ".rate", sep = "")
row.names(results)[counter.a]
paste(groups[i], ".rate", sep = "")
foo <- "heath"
foo <- c(foo, "blackmon")
foo
for(i in 1:length(groups)){
baq <- paste(groups[i], ".rate", sep = "")
baq <- c(baq, paste(groups[i], ".SE", sep = ""))}
baq <- vector()
results <- matrix(,46,100)
foo <- vector()
for(i in 1:length(groups)){
baq <- c(baq, paste(groups[i], ".rate", sep = ""))
baq <- c(baq, paste(groups[i], ".SE", sep = ""))}
row.names(results) <- baq
results
groups <- c("Bembidion", "Calathus", "Carabidae", "Carabus",
"Cerambycidae", "Chrysolina", "Chrysomelidae",
"Cicindela", "Timarcha", "Tenebrionidae", "Scarabaeidae",
"Pterostichus", "Pimelia", "Lampyridae", "Ips",
"Harpalus", "Elateridae", "Dytiscidae", "Diabrotica",
"Dendroctonus", "Cytronus", "Curculionidae", "Coccinellidae")
counter.a <- 1
counter.b <- 2
baq <- vector()
results <- matrix(,46,100)
foo <- vector()
for(i in 1:length(groups)){
baq <- c(baq, paste(groups[i], ".rate", sep = ""))
baq <- c(baq, paste(groups[i], ".SE", sep = ""))}
setwd(paste("~/Desktop/Dropbox/papers/chrom.num/data and analysis/analyses/brownian/", groups[i], sep = ""))
for(j in 1:100){
tree <- read.tree(paste(groups[i], i, ".tree", sep = ""))
data <- read.csv("data.csv")
dat <- data[, 2]
names(dat) <- data[, 1]
foo <- ace(dat, tree, type = "cont", model = "BM")
results[counter.a, j] <- foo$sigma[1]
results[counter.b, j] <- foo$sigma[2]
}
counter.a <- counter.a + 1
counter.b <- counter.b + 1
}
row.names(results) <- baq
groups <- c("Bembidion", "Calathus", "Carabidae", "Carabus",
"Cerambycidae", "Chrysolina", "Chrysomelidae",
"Cicindela", "Timarcha", "Tenebrionidae", "Scarabidae",
"Pterostichus", "Pimelia", "Lampyridae", "Ips",
"Harpalus", "Elateridae", "Dytiscidae", "Diabrotica",
"Dendroctonus", "Cytronus", "Curculionidae", "Coccinelidae")
counter.a <- 1
counter.b <- 2
baq <- vector()
results <- matrix(,46,100)
foo <- vector()
for(i in 1:length(groups)){
baq <- c(baq, paste(groups[i], ".rate", sep = ""))
baq <- c(baq, paste(groups[i], ".SE", sep = ""))}
setwd(paste("~/Desktop/Dropbox/papers/chrom.num/data and analysis/analyses/brownian/", groups[i], sep = ""))
for(j in 1:100){
cat(j)
tree <- read.tree(paste(groups[i], i, ".tree", sep = ""))
data <- read.csv("data.csv")
dat <- data[, 2]
names(dat) <- data[, 1]
foo <- ace(dat, tree, type = "cont", model = "BM")
results[counter.a, j] <- foo$sigma[1]
results[counter.b, j] <- foo$sigma[2]
}
groups <- c("Bembidion", "Calathus", "Carabidae", "Carabus",
"Cerambycidae", "Chrysolina", "Chrysomelidae",
"Cicindela", "Timarcha", "Tenebrionidae", "Scarabidae",
"Pterostichus", "Pimelia", "Lampyridae", "Ips",
"Harpalus", "Elateridae", "Dytiscidae", "Diabrotica",
"Dendroctonus", "Cytronus", "Curculionidae", "Coccinelidae")
counter.a <- 1
counter.b <- 2
baq <- vector()
results <- matrix(,46,100)
foo <- vector()
for(i in 1:length(groups)){
baq <- c(baq, paste(groups[i], ".rate", sep = ""))
baq <- c(baq, paste(groups[i], ".SE", sep = ""))}
setwd(paste("~/Desktop/Dropbox/papers/chrom.num/data and analysis/analyses/brownian/", groups[i], sep = ""))
for(j in 1:100){
cat(paste(j, "\n"))
tree <- read.tree(paste(groups[i], i, ".tree", sep = ""))
data <- read.csv("data.csv")
dat <- data[, 2]
names(dat) <- data[, 1]
foo <- ace(dat, tree, type = "cont", model = "BM")
results[counter.a, j] <- foo$sigma[1]
results[counter.b, j] <- foo$sigma[2]
}
counter.a <- counter.a + 1
counter.b <- counter.b + 1
}
row.names(results) <- baq
groups <- c("Bembidion", "Calathus", "Carabidae", "Carabus",
"Cerambycidae", "Chrysolina", "Chrysomelidae",
"Cicindela", "Timarcha", "Tenebrionidae", "Scarabidae",
"Pterostichus", "Pimelia", "Lampyridae", "Ips",
"Harpalus", "Elateridae", "Dytiscidae", "Diabrotica",
"Dendroctonus", "Cytronus", "Curculionidae", "Coccinelidae")
counter.a <- 1
counter.b <- 2
baq <- vector()
results <- matrix(,46,100)
foo <- vector()
for(i in 1:length(groups)){
baq <- c(baq, paste(groups[i], ".rate", sep = ""))
baq <- c(baq, paste(groups[i], ".SE", sep = ""))
setwd(paste("~/Desktop/Dropbox/papers/chrom.num/data and analysis/analyses/brownian/", groups[i], sep = ""))
for(j in 1:100){
cat(paste(j, "\n"))
tree <- read.tree(paste(groups[i], i, ".tree", sep = ""))
data <- read.csv("data.csv")
dat <- data[, 2]
names(dat) <- data[, 1]
foo <- ace(dat, tree, type = "cont", model = "BM")
results[counter.a, j] <- foo$sigma[1]
results[counter.b, j] <- foo$sigma[2]
}
counter.a <- counter.a + 1
counter.b <- counter.b + 1
}
row.names(results) <- baq
View(results)
warnings
warnings()
results()
results
write.csv(results, file="results1.csv")
getwd()
groups <- c("Pimelia", "Lampyridae", "Ips",
"Harpalus", "Elateridae", "Dytiscidae", "Diabrotica",
"Dendroctonus", "Cytronus", "Curculionidae", "Coccinelidae")
counter.a <- 1
counter.b <- 2
baq <- vector()
results <- matrix(,46,100)
foo <- vector()
i <- 1
setwd(paste("~/Desktop/Dropbox/papers/chrom.num/data and analysis/analyses/brownian/", groups[i], sep = ""))
j <- 1
tree <- read.tree(paste(groups[i], i, ".tree", sep = ""))
data <- read.csv("data.csv")
dat <- data[, 2]
names(dat) <- data[, 1]
ace(dat, tree, type = "cont", model = "BM")
View(data)
groups <- c("Pimelia", "Lampyridae", "Ips",
"Harpalus", "Elateridae", "Dytiscidae", "Diabrotica",
"Dendroctonus", "Cytronus", "Curculionidae", "Coccinelidae")
counter.a <- 1
counter.b <- 2
baq <- vector()
results <- matrix(,46,100)
foo <- vector()
for(i in 1:length(groups)){
baq <- c(baq, paste(groups[i], ".rate", sep = ""))
baq <- c(baq, paste(groups[i], ".SE", sep = ""))
setwd(paste("~/Desktop/Dropbox/papers/chrom.num/data and analysis/analyses/brownian/", groups[i], sep = ""))
for(j in 1:100){
cat(paste(j, "\n"))
tree <- read.tree(paste(groups[i], i, ".tree", sep = ""))
data <- read.csv("data.csv")
dat <- data[, 2]
names(dat) <- data[, 1]
foo <- ace(dat, tree, type = "cont", model = "BM")
results[counter.a, j] <- foo$sigma[1]
results[counter.b, j] <- foo$sigma[2]
}
counter.a <- counter.a + 1
counter.b <- counter.b + 1
}
row.names(results) <- baq
View(results)
results
row.names(results) <- baq
row.names(results) <- baq
foobar <- results[1:22,]
row.names(foobar)<- baq
foobar
